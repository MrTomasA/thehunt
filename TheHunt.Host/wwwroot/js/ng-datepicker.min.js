angular.module("jkuri.datepicker",[]).directive("ngDatepicker",["$document",function(n){"use strict";var t=function(n,t){n.format=t.format||"YYYY-MM-DD";n.viewFormat=t.viewFormat||"Do MMMM YYYY";n.locale=t.locale||"en";n.firstWeekDaySunday=n.$eval(t.firstWeekDaySunday)||!1;n.placeholder=t.placeholder||""};return{restrict:"EA",require:"?ngModel",scope:{},link:function(i,r,u,f){var s;t(i,u);i.calendarOpened=!1;i.days=[];i.dayNames=[];i.viewValue=null;i.dateValue=null;moment.locale(i.locale);var e=moment(),o=function(n){var f=n.endOf("month").date(),e=n.month(),o=n.year(),r=1,u=i.firstWeekDaySunday===!0?n.set("date",2).day():n.set("date",1).day(),t;for(u!==1&&(r-=u-1),i.dateValue=n.format("MMMM YYYY"),i.days=[],t=r;t<=f;t+=1)t>0?i.days.push({day:t,month:e+1,year:o,enabled:!0}):i.days.push({day:null,month:null,year:null,enabled:!1})},h=function(){for(var n=i.firstWeekDaySunday===!0?moment("2015-06-07"):moment("2015-06-01"),t=0;t<7;t+=1)i.dayNames.push(n.format("ddd")),n.add("1","d")};h();i.showCalendar=function(){i.calendarOpened=!0;o(e)};i.closeCalendar=function(){i.calendarOpened=!1};i.prevYear=function(){e.subtract(1,"Y");o(e)};i.prevMonth=function(){e.subtract(1,"M");o(e)};i.nextMonth=function(){e.add(1,"M");o(e)};i.nextYear=function(){e.add(1,"Y");o(e)};i.selectDate=function(n,t){n.preventDefault();var r=moment(t.day+"."+t.month+"."+t.year,"DD.MM.YYYY");f.$setViewValue(r.format(i.format));i.viewValue=r.format(i.viewFormat);i.closeCalendar()};s=["ng-datepicker","ng-datepicker-input"];u.id!==undefined&&s.push(u.id);n.on("click",function(n){var t,r,u,f;if(i.calendarOpened&&(t=0,n.target)){for(r=n.target;r;r=r.parentNode)if(u=r.id,f=r.className,u!==undefined)for(t=0;t<s.length;t+=1)if(u.indexOf(s[t])>-1||f.indexOf(s[t])>-1)return;i.closeCalendar();i.$apply()}});f.$render=function(){var n=f.$viewValue;n!==undefined&&(i.viewValue=moment(n).format(u.viewFormat),i.dateValue=n)}},template:'<div><input type="text" ng-focus="showCalendar()" ng-value="viewValue" class="ng-datepicker-input" placeholder="{{ placeholder }}"><\/div><div class="ng-datepicker" ng-show="calendarOpened">  <div class="controls">    <div class="left">      <i class="fa fa-backward prev-year-btn" ng-click="prevYear()"><\/i>      <i class="fa fa-angle-left prev-month-btn" ng-click="prevMonth()"><\/i>    <\/div>    <span class="date" ng-bind="dateValue"><\/span>    <div class="right">      <i class="fa fa-angle-right next-month-btn" ng-click="nextMonth()"><\/i>      <i class="fa fa-forward next-year-btn" ng-click="nextYear()"><\/i>    <\/div>  <\/div>  <div class="day-names">    <span ng-repeat="dn in dayNames">      <span>{{ dn }}<\/span>    <\/span>  <\/div>  <div class="calendar">    <span ng-repeat="d in days">      <span class="day" ng-click="selectDate($event, d)" ng-class="{disabled: !d.enabled}">{{ d.day }}<\/span>    <\/span>  <\/div><\/div>'}}]);